---

- name: Prepare folders
  file: path={{ item }} state=directory
  with_items:
    - "{{ services_dir }}/loadbalancer/service/passport"

- name: Assemble nginx consul-template config
  template: src=nginx.consul-template.conf.j2 dest={{ services_dir }}/loadbalancer/consul-templates/passport.conf

- name: Assemble consul-template service config
  template:
    src: consul-template.service.j2
    dest: "{{ services_dir }}/loadbalancer/service/passport/run"
    mode: 'u+x'
